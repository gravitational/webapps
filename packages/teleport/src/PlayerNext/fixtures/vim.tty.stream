]0;rjones@rusty-dev-1904: ~rjones@rusty-dev-1904:~$ ssh ll
Warning: Permanently added '[localhost]:2022' (RSA) to the list of known hosts.
Welcome to Ubuntu 19.04 (GNU/Linux 5.0.0-1011-gcp x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Fri Oct  4 21:38:37 UTC 2019

  System load:  0.35              Processes:           149
  Usage of /:   50.6% of 9.52GB   Users logged in:     1
  Memory usage: 15%               IP address for ens4: 10.128.0.43
  Swap usage:   0%

 * Kata Containers are now fully integrated in Charmed Kubernetes 1.16!
   Yes, charms take the Krazy out of K8s Kata Kluster Konstruction.

     https://ubuntu.com/kubernetes/docs/release-notes

32 updates can be installed immediately.
0 of these updates are security updates.


*** System restart required ***
rjones@rusty-dev-1904:~$ ll
total 3228
drwxr-xr-x 11 rjones rjones    4096 Oct  4 21:36 ./
drwxr-xr-x 21 root   root      4096 Sep 19 09:35 ../
-rw-------  1 root   root       434 Aug 14 00:14 .bash_history
-rw-r--r--  1 rjones rjones     220 Apr  4  2019 .bash_logout
-rw-r--r--  1 rjones rjones    3771 Apr  4  2019 .bashrc
drwx------  3 rjones rjones    4096 Aug 28 21:54 .cache/
drwx------  3 rjones rjones    4096 Sep 17 01:04 .config/
-rw-rw-r--  1 rjones rjones      84 Aug 31 00:59 .gitconfig
drwx------  3 rjones rjones    4096 Aug 13 22:32 .gnupg/
-rw-------  1 rjones rjones      53 Sep 25 20:12 .lesshst
drwxrwxr-x  3 rjones rjones    4096 Aug 31 00:59 .local/
drwxrwxr-x  7 rjones rjones    4096 Sep 17 01:14 .npm/
-rw-r--r--  1 rjones rjones     959 Aug 31 00:55 .profile
drwx------  2 rjones rjones    4096 Aug 29 17:40 .ssh/
drwxrwxr-x  3 rjones rjones    4096 Aug 30 22:56 .vim/
-rw-------  1 rjones rjones   27248 Oct  4 21:36 .viminfo
-rw-rw-r--  1 rjones rjones     189 Sep  3 17:11 .vimrc
drwxrwxr-x  4 rjones rjones    4096 Sep 25 20:11 Development/
-rw-rw-r--  1 rjones rjones       8 Sep 20 00:13 bar.txt
-rw-rw-r--  1 rjones rjones    2605 Sep  9 20:23 copy.txt
-rwxrwxr-x  1 rjones rjones 3185680 Sep 30 23:35 execsnoop*
-rw-rw-r--  1 rjones rjones       5 Sep 24 18:01 file.txt
drwxrwxr-x  5 rjones rjones    4096 Aug 28 22:01 go/
-rwxrwxr-x  1 rjones rjones      40 Sep 24 20:14 script.sh*
rjones@rusty-dev-1904:~$ r
rjones@rusty-dev-1904:~/go/src/github.com/gravitational/rusty/sshd-ebpf$ ll
total 45028
drwxrwxr-x  6 rjones rjones     4096 Oct  4 21:37 ./
drwxrwxr-x 13 rjones rjones     4096 Oct  4 20:36 ../
-rw-rw-r--  1 rjones rjones      155 Oct  4 20:50 Makefile
drwxrwxr-x  2 rjones rjones     4096 Oct  4 21:36 bpf/
-rw-rw-r--  1 rjones rjones     2585 Oct  4 21:37 main.go
drwxrwxr-x  2 rjones rjones     4096 Oct  4 21:38 sessions/
drwxrwxr-x  2 rjones rjones     4096 Oct  4 20:37 sshd/
-rwxrwxr-x  1 rjones rjones  7545840 Oct  4 21:37 sshd-ebpf*
-rw-rw-r--  1 rjones rjones 38524046 Oct  4 20:38 teleport_4.1.0_amd64.deb
drwxrwxr-x  3 rjones rjones     4096 Oct  4 20:37 vendor/
rjones@rusty-dev-1904:~/go/src/github.com/gravitational/rusty/sshd-ebpf$ vi main.go 
[m[m[0m[H[2J[54;1H"main.go" 141L, 2585C[2;1Hâ–½[6n[2;1H  [1;1H[1;1H[33mpackage[0m main

[33mimport[0m ([4;9H[31m"crypto/rand"[5;9H"encoding/hex"[6;9H"fmt"[7;9H"log"[8;9H"os"[9;9H"os/exec"[10;9H"os/user"[11;9H"strconv"[12;9H"syscall"[14;9H"github.com/gravitational/rusty/sshd-ebpf/bpf"[15;9H"github.com/gravitational/rusty/sshd-ebpf/sshd"[17;9H"github.com/gravitational/teleport/lib/pam"[0m
)

[33mvar[0m _ = pam.Open
[33mvar[0m _ = fmt.Printf

[33mfunc[0m creds() *syscall.Credential {[24;9Hu, err := user.Lookup([31m"rjones"[0m)[25;9H[33mif[0m err != [33mnil[0m {[26;17Hlog.Fatal(err)[27;9H}[29;9Huid, err := strconv.Atoi(u.Uid)[30;9H[33mif[0m err != [33mnil[0m {[31;17Hlog.Fatal(err)[32;9H}[33;9Hgid, err := strconv.Atoi(u.Gid)[34;9H[33mif[0m err != [33mnil[0m {[35;17Hlog.Fatal(err)[36;9H}[38;9Hg, err := u.GroupIds()[39;9H[33mif[0m err != [33mnil[0m {[40;17Hlog.Fatal(err)[41;9H}[42;9Hgroups := [33mmake[0m([][32muint32[0m, [31m0[0m)[43;9H[33mfor[0m _, sgid := [33mrange[0m g {[44;17Higid, err := strconv.Atoi(sgid)[45;17H[33mif[0m err != [33mnil[0m {[46;25H[33mcontinue[0m[47;17H} [33melse[0m {[48;25Hgroups = [33mappend[0m(groups, [32muint32[0m(igid))[49;17H}[50;9H}[52;9H[34m//fmt.Printf("--> uid: %v, gid: %v, groups: %v.\n", uid, gid, groups)[0m[54;168H1,1[11CTop[1;1H[54;158H~@k[1;1H[54;158H   [2;1H[54;168H2,0-1[2;1H[54;158H~@k[2;1H[54;158H   [3;1H[54;168H3,1  [3;1H[54;158H/[3;1H[54;1H[K[54;1H/s[8;11H[7m[31ms[0m[54;168H8,4-11[8CTop[54;168H[K[54;3H[54;2H[K[8;11H[31ms[0m[54;168H3,1[11CTop[54;168H[K[54;2Hu[10;13H[7m[31mu[0m[54;168H10,6-13[7CTop[54;168H[K[54;3Hs[10;14H[7m[31ms[0m[54;168H10,6-13[7CTop[54;168H[K[54;4He[10;15H[7m[31me[0m[54;168H10,6-13[7CTop[54;168H[K[54;5Hr[10;16H[7m[31mr[0m[54;168H10,6-13[7CTop[54;168H[K[54;6H[10;13H[31muser[0m[54;168H10,6-13[7CTop[10;13H[54;158Hn[10;13H[54;158H[K[54;1H[24;19H[54;168H24,12-19      Top[24;19H[54;158Hn[24;19H[54;158H[K[54;1H[31msearch hit BOTTOM, continuing at TOP[10;13H[0m[54;168H10,6-13[7CTop[54;168H[K[54;168H10,6-13[7CTop[10;13H[54;158H~@k[10;13H[54;158H   [11;13H[54;169H1[11;13H[54;158H~@k[11;13H[54;158H   [12;13H[54;169H2[12;13H[54;158H~@k[12;13H[54;158H   [13;1H[54;169H3,0-1 [13;1H[54;158H~@k[13;1H[54;158H   [14;13H[54;169H4,6-13[14;13H[54;158H~@k[14;13H[54;158H   [15;13H[54;169H5[15;13H[54;158H~@k[15;13H[54;158H   [16;1H[54;169H6,0-1 [16;1H[54;158H~@k[16;1H[54;158H   [17;13H[54;169H7,6-13[17;13H[54;158H~@k[17;13H[54;158H   [18;1H[3;8H[46m([18;1H)[0m[54;169H8,1   [18;1H[54;158H~@k[18;1H[54;158H   [19;1H[3;8H([18;1H)[54;169H9,0-1[19;1H[54;158H~@k[19;1H[54;158H   [20;13H[54;168H20,13 [20;13H[54;158H~@k[20;13H[54;158H   [21;13H[54;169H1[21;13H[54;158H~@k[21;13H[54;158H   [22;1H[54;169H2,0-1[22;1H[54;158H~@k[22;1H[54;158H   [23;13H[54;169H3,13 [23;13H[54;158H~@k[23;13H[54;158H   [24;13H[54;169H4,6-13[24;13H[54;158H~@k[24;13H[54;158H   [25;13H[54;169H5[25;13H[54;158H~@k[25;13H[54;158H   [26;16H[54;169H6,2-16[26;16H[54;158H~@k[26;16H[54;158H   [27;9H[25;23H[46m{[27;9H}[0m[54;169H7,2-9 [27;9H[54;158H~@k[27;9H[54;158H   [28;1H[25;23H{[27;9H}[54;169H8,0-1[28;1H[54;158Ho[28;1H[54;158H [29;9H[54;1H[1m-- INSERT --[0m[54;13H[K[54;168H29,2-9[8CTop[29;1H[L[29;1H[1m[37m[41m        [0m[54;1H[1m-- INSERT --[0m[155C29,2-9[8CTop[29;9H[53;9H[K[30;1H[L[29;1H[K[30;1H[1m[37m[41m        [0m[54;1H[1m-- INSERT --[0m[155C30,2-9[8CTop[30;9H
[L[30;1H[K[31;1H[1m[37m[41m        [0m[54;1H[1m-- INSERT --[0m[155C31,2-9[8CTop[31;9H[53;9H[K[32;1H[L[31;1H[K[32;1H[1m[37m[41m        [0m[54;1H[1m-- INSERT --[0m[155C32,2-9[8CTop[32;9H[32;1H[K[54;169H1,1  [31;1H[54;1H[K[31;1H[54;158H^[[31;1H[54;158H  [31;1H[54;168H31,0-1[8CTop[31;1H[54;158H~@k[31;1H[54;158H   [30;1H[54;169H0[30;1H[54;158H^[[30;1H[54;158H  [30;1H[54;158H^[[30;1H[54;158H  [30;1H[54;158Hd[30;1H[54;159Hd[30;1H[54;158H  [30;1H[M[53;9H}[53;168H[K[54;168H30,0-1[8CTop[30;1H[54;158Hi[30;1H[54;158H [30;1H[54;1H[1m-- INSERT --[0m[54;168H[K[54;168H30,1[10CTop[30;1Ha[54;171H2[30;2Ha[54;171H3[30;3Ha[54;171H4[30;4Hf[54;171H5[30;5Ha[54;171H6[30;6Hs[54;171H7[30;7Hf[54;171H8[30;8H[54;1H[K[30;7H[54;158H^[[30;7H[54;158H  [30;8H[54;168H30,7[10CTop[30;7H[54;158Hd[30;7H[54;159Hd[30;7H[54;158H  [30;1H[M[53;168H[K[54;168H30,0-1[8CTop[30;1H[54;158H~@k[30;1H[54;158H   [29;1H[54;168H29[29;1H[54;158Hd[29;1H[54;159Hd[29;1H[54;158H  [29;1H[M[53;9H[34m//fmt.Printf("--> uid: %v, gid: %v, groups: %v.\n", uid, gid, groups)[0m[53;168H[K[54;168H29,0-1[8CTop[29;1H[54;158H:[29;1H[54;158H[K[54;1H:w"main.go" 142L, 2586C written[29;1H[54;168H29,0-1[8CTop[54;168H[K[54;168H29,0-1[8CTop[29;1H[54;158Hd[29;1H[54;159Hd[29;1H[54;158H  [29;9H[M[53;1H[K[54;168H29,2-9[8CTop[29;9H[54;158H:[29;9H[54;158H[K[54;1H:w"main.go" 141L, 2585C written[29;9H[54;168H29,2-9[8CTop[54;168H[K[54;168H29,2-9[8CTop[29;9H[54;158HZ[29;9H[54;159HZ[29;9H[54;1H[54;1H[K[54;1Hrjones@rusty-dev-1904:~/go/src/github.com/gravitational/rusty/sshd-ebpf$ vi Makefile 
[m[m[0m[H[2J[54;1H"Makefile" 8L, 155C[2;1Hâ–½[6n[2;1H  [1;1H[1;1H[36mall:[0m build run

[36mbuild:[0m
[31m        /usr/local/go/bin/go build -o sshd-ebpf -tags pam main.go[0m

[36mrun:[0m
[31m        sudo systemctl restart sshd-ebpf
        sudo journalctl -u sshd-ebpf -f[0m
[1m[34m~                                                                                                                                                                                        [10;1H~                                                                                                                                                                                        [11;1H~                                                                                                                                                                                        [12;1H~                                                                                                                                                                                        [13;1H~                                                                                                                                                                                        [14;1H~                                                                                                                                                                                        [15;1H~                                                                                                                                                                                        [16;1H~                                                                                                                                                                                        [17;1H~                                                                                                                                                                                        [18;1H~                                                                                                                                                                                        [19;1H~                                                                                                                                                                                        [20;1H~                                                                                                                                                                                        [21;1H~                                                                                                                                                                                        [22;1H~                                                                                                                                                                                        [23;1H~                                                                                                                                                                                        [24;1H~                                                                                                                                                                                        [25;1H~                                                                                                                                                                                        [26;1H~                                                                                                                                                                                        [27;1H~                                                                                                                                                                                        [28;1H~                                                                                                                                                                                        [29;1H~                                                                                                                                                                                        [30;1H~                                                                                                                                                                                        [31;1H~                                                                                                                                                                                        [32;1H~                                                                                                                                                                                        [33;1H~                                                                                                                                                                                        [34;1H~                                                                                                                                                                                        [35;1H~                                                                                                                                                                                        [36;1H~                                                                                                                                                                                        [37;1H~                                                                                                                                                                                        [38;1H~                                                                                                                                                                                        [39;1H~                                                                                                                                                                                        [40;1H~                                                                                                                                                                                        [41;1H~                                                                                                                                                                                        [42;1H~                                                                                                                                                                                        [43;1H~                                                                                                                                                                                        [44;1H~                                                                                                                                                                                        [45;1H~                                                                                                                                                                                        [46;1H~                                                                                                                                                                                        [47;1H~                                                                                                                                                                                        [48;1H~                                                                                                                                                                                        [49;1H~                                                                                                                                                                                        [50;1H~                                                                                                                                                                                        [51;1H~                                                                                                                                                                                        [52;1H~                                                                                                                                                                                        [53;1H~                                                                                                                                                                                        [0m[54;168H1,1[11CAll[1;1H[54;158HZ[1;1H[54;159HZ[1;1H[54;1H[54;1H[K[54;1Hrjones@rusty-dev-1904:~/go/src/github.com/gravitational/rusty/sshd-ebpf$ /usr/local/go/bin/go build -o sshd-ebpf -tags pam main.go
rjones@rusty-dev-1904:~/go/src/github.com/gravitational/rusty/sshd-ebpf$ exit
logout
Connection to localhost closed.
]0;rjones@rusty-dev-1904: ~rjones@rusty-dev-1904:~$ 